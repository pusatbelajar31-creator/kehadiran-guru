<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Aplikasi Kontrol Kelas - Monitoring Kehadiran Guru</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: {
                50: "#eff6ff",
                100: "#dbeafe",
                200: "#bfdbfe",
                300: "#93c5fd",
                400: "#60a5fa",
                500: "#3b82f6",
                600: "#2563eb",
                700: "#1d4ed8",
                800: "#1e40af",
                900: "#1e3a8a",
              },
              soft: "#0b1220",
            },
            boxShadow: { soft: "0 10px 25px rgba(0,0,0,0.20)" },
            fontFamily: {
              sans: [
                "Inter",
                "system-ui",
                "Segoe UI",
                "Roboto",
                "Helvetica",
                "Arial",
                "Apple Color Emoji",
                "Segoe UI Emoji",
              ],
            },
          },
        },
      };
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      .transition-fast {
        transition: all 0.2s ease;
      }
      .transition-slow {
        transition: all 0.35s ease;
      }
      .slide-in {
        transform: translateX(-100%);
        transition: transform 0.35s ease;
      }
      .slide-in.open {
        transform: translateX(0);
      }
      .table-wrap {
        overflow-x: auto;
      }
      @keyframes floaty {
        0% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-4px);
        }
        100% {
          transform: translateY(0);
        }
      }
      .floaty {
        animation: floaty 4s ease-in-out infinite;
      }
      body {
        background-image: radial-gradient(
            transparent 1px,
            rgba(0, 0, 0, 0.02) 1px
          ),
          linear-gradient(180deg, rgba(0, 0, 0, 0.04), rgba(0, 0, 0, 0));
        background-size: 16px 16px, 100% 100%;
      }
    </style>
  </head>
  <body class="font-sans bg-white text-slate-800">
    <div id="app" class="min-h-screen">
      <!-- Top Bar (Test tools hidden as requested) -->
      <div class="bg-white/90 backdrop-blur border-b border-slate-200">
        <div
          class="max-w-7xl mx-auto px-4 py-3 flex flex-col md:flex-row gap-3 md:items-center md:justify-between"
        >
          <div class="flex items-center gap-3">
            <div
              class="w-12 h-12 rounded-lg bg-blue-700 text-white font-extrabold flex items-center justify-center shadow-soft"
            >
              MKG
            </div>
            <div>
              <div class="text-slate-900 font-bold">SMAN 3 KOTA SUKABUMI</div>
              <div class="text-xs text-slate-500">
                Monitoring Kehadiran Guru
              </div>
            </div>
          </div>
          <div class="flex-1 md:max-w-2xl">
            <div class="flex hidden items-center gap-2">
              <input
                id="urlInput"
                type="text"
                disabled
                value="https://script.google.com/macros/s/AKfycbzYOp_jzpHW9B0zZs39iMCd7hcetg7jUIYDY6Td_cDyQmdumFOd1RXXlXsqZXDAvrpu/exec"
                class="w-full border border-slate-200 rounded-lg px-3 py-2.5 bg-white text-slate-600 placeholder-slate-400"
              />
              <button
                id="saveUrl"
                disabled
                class="bg-slate-100 text-slate-500 font-semibold rounded-lg px-4 py-2.5 cursor-not-allowed border border-slate-200"
              >
                Terkunci
              </button>
            </div>
            <!-- Hidden test controls -->
            <div class="hidden items-center gap-3 mt-2">
              <button
                id="testKoneksi"
                class="px-3 py-1.5 rounded-lg border border-slate-200 hover:bg-slate-50 text-slate-700 transition-fast"
              >
                Tes Koneksi
              </button>
              <span
                id="modeBadge"
                class="text-xs px-2 py-1 rounded bg-blue-100 text-blue-700"
                >Memeriksa koneksi…</span
              >
              <span id="sheetHint" class="text-xs text-slate-500"
                >Terhubung ke Google Apps Script</span
              >
            </div>
            <div
              id="connDetail"
              class="hidden mt-2 text-xs rounded-lg border border-slate-200 bg-slate-50 text-slate-700 px-3 py-2"
            ></div>
            <div class="text-xs text-slate-500 mt-1"></div>
          </div>
        </div>
      </div>

      <!-- Login -->
      <section
        id="loginView"
        class="min-h-[70vh] flex items-center justify-center px-6 py-10"
      >
        <div
          class="w-full max-w-5xl grid grid-cols-1 lg:grid-cols-2 gap-10 items-center"
        >
          <div
            class="bg-white border border-slate-200 rounded-2xl shadow-soft p-8 lg:p-10"
          >
            <div class="flex items-center gap-3 mb-6">
              <div
                class="w-12 h-12 rounded-xl bg-primary-600 flex items-center justify-center text-white font-extrabold shadow-soft"
              >
                MKG
              </div>
              <div>
                <h1 class="text-2xl font-bold text-slate-900">
                  Masuk Aplikasi
                </h1>
                <p class="text-slate-500 text-sm">Pilih role lalu masuk</p>
              </div>
            </div>

            <div
              class="rounded-xl px-4 py-3 mb-6 text-sm border border-slate-200 bg-slate-50 text-slate-700"
              id="connectedNote"
            >
              Memeriksa koneksi ke server...
            </div>

            <form id="loginForm" class="space-y-4">
              <div>
                <label class="block text-sm font-medium mb-1 text-slate-700"
                  >Username</label
                >
                <div class="relative">
                  <span class="absolute left-3 top-2.5 text-primary-500">
                    <svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M20 21a8 8 0 10-16 0"></path>
                      <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                  </span>
                  <input
                    id="loginUsername"
                    type="text"
                    required
                    placeholder="Masukkan username"
                    class="w-full border border-slate-300 rounded-lg pl-10 pr-3 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800 placeholder-slate-400 transition-fast"
                  />
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium mb-1 text-slate-700"
                  >Password</label
                >
                <div class="relative">
                  <span class="absolute left-3 top-2.5 text-primary-500">
                    <svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <rect x="4" y="11" width="16" height="9" rx="2"></rect>
                      <path d="M8 11V7a4 4 0 1 1 8 0v4"></path>
                    </svg>
                  </span>
                  <input
                    id="loginPassword"
                    type="password"
                    required
                    placeholder="Masukkan password"
                    class="w-full border border-slate-300 rounded-lg pl-10 pr-10 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800 placeholder-slate-400 transition-fast"
                  />
                  <button
                    type="button"
                    id="togglePass"
                    class="absolute right-2 top-2.5 text-slate-500 hover:text-slate-700 p-1 rounded transition-fast"
                    aria-label="Tampilkan/Sembunyikan Password"
                  >
                    <svg
                      id="eyeIcon"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                    >
                      <path
                        d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12Z"
                      ></path>
                      <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                  </button>
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium mb-1 text-slate-700"
                  >Role</label
                >
                <div class="relative">
                  <span class="absolute left-3 top-2.5 text-primary-500">
                    <svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M16 21v-2a4 4 0 0 0-8 0v2"></path>
                      <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                  </span>
                  <select
                    id="loginRole"
                    class="w-full border border-slate-300 rounded-lg pl-10 pr-3 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800 transition-fast"
                  >
                    <option>Ketua Kelas</option>
                    <option>Kepala Sekolah</option>
                    <option>Wakasek Kurikulum</option>
                    <option>Administrator</option>
                  </select>
                </div>
              </div>

              <button
                type="submit"
                id="loginBtn"
                class="w-full bg-blue-700 hover:bg-blue-800 text-white font-semibold rounded-lg py-2.5 transition-fast shadow-md shadow-blue-500/20"
              >
                <span id="loginBtnText">Login</span>
                <span
                  id="loginSpinner"
                  class="hidden ml-2 inline-block align-middle"
                >
                  <svg
                    class="animate-spin"
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <circle cx="12" cy="12" r="10" stroke-opacity="0.2" />
                    <path d="M12 2a10 10 0 0 1 10 10" />
                  </svg>
                </span>
              </button>
            </form>
          </div>

          <div class="hidden lg:block">
            <div
              class="bg-white border border-slate-200 rounded-2xl shadow-soft p-10"
            >
              <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-semibold text-slate-900">
                  Selamat Datang
                </h2>
                <span
                  class="text-xs text-primary-700 bg-primary-100 px-2 py-1 rounded border border-primary-200"
                  >Modern • Minimalis</span
                >
              </div>
              <div class="w-full">
                <svg
                  viewBox="0 0 600 360"
                  xmlns="http://www.w3.org/2000/svg"
                  class="w-full h-auto"
                >
                  <defs>
                    <linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">
                      <stop offset="0%" stop-color="#93c5fd" />
                      <stop offset="100%" stop-color="#3b82f6" />
                    </linearGradient>
                  </defs>
                  <rect
                    x="40"
                    y="260"
                    width="520"
                    height="18"
                    rx="9"
                    fill="rgba(0,0,0,0.06)"
                  />
                  <rect
                    x="180"
                    y="130"
                    width="240"
                    height="140"
                    rx="12"
                    fill="url(#g1)"
                  />
                  <rect
                    x="200"
                    y="150"
                    width="200"
                    height="90"
                    rx="8"
                    fill="rgba(255,255,255,0.95)"
                  />
                  <rect
                    x="240"
                    y="255"
                    width="120"
                    height="10"
                    rx="5"
                    fill="#c7d2fe"
                  />
                  <circle
                    cx="120"
                    cy="150"
                    r="28"
                    fill="#93c5fd"
                    class="floaty"
                  />
                  <rect
                    x="95"
                    y="180"
                    width="50"
                    height="60"
                    rx="12"
                    fill="#bfdbfe"
                    class="floaty"
                  />
                  <rect
                    x="420"
                    y="110"
                    width="120"
                    height="80"
                    rx="10"
                    fill="rgba(0,0,0,0.06)"
                  />
                  <rect
                    x="435"
                    y="165"
                    width="16"
                    height="20"
                    rx="4"
                    fill="#93c5fd"
                  />
                  <rect
                    x="455"
                    y="155"
                    width="16"
                    height="30"
                    rx="4"
                    fill="#60a5fa"
                  />
                  <rect
                    x="475"
                    y="145"
                    width="16"
                    height="40"
                    rx="4"
                    fill="#3b82f6"
                  />
                  <circle cx="470" cy="230" r="34" fill="rgba(0,0,0,0.08)" />
                  <path
                    d="M470 230 L470 196 A34 34 0 0 1 503 223 Z"
                    fill="#60a5fa"
                  />
                  <path
                    d="M470 230 L503 223 A34 34 0 0 1 470 264 Z"
                    fill="#3b82f6"
                  />
                </svg>
              </div>
              <p class="text-slate-700 text-sm mt-6">Grafik</p>
            </div>
          </div>
        </div>
      </section>

      <!-- App Shell -->
      <section id="appShell" class="hidden">
        <div class="flex min-h-screen">
          <!-- Sidebar -->
          <aside
            id="sidebar"
            class="fixed lg:static top-0 left-0 h-full lg:h-auto w-72 bg-white border-r border-slate-200 shadow-soft lg:shadow-none z-30 slide-in lg:transform-none lg:open"
          >
            <div
              class="h-16 border-b border-slate-200 flex items-center px-4 justify-between lg:justify-start"
            >
              <div class="flex items-center gap-3">
                <div
                  class="w-10 h-10 rounded-lg bg-blue-700 text-white font-extrabold flex items-center justify-center shadow-soft"
                >
                  SK
                </div>
                <div>
                  <div class="text-slate-900 font-bold">Kontrol Kelas</div>
                  <div
                    id="roleBadge"
                    class="text-xs text-blue-700 bg-blue-100 border border-blue-200 px-2 py-0.5 rounded"
                  >
                    Role
                  </div>
                </div>
              </div>
              <button
                id="closeSidebar"
                class="lg:hidden p-2 rounded hover:bg-slate-100 transition-fast text-slate-700"
                aria-label="Tutup menu"
              >
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>

            <nav class="p-4">
              <div id="menuClassLeader" class="space-y-1 hidden">
                <a
                  data-target="page-ketua-input"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M4 7h16M4 12h16M4 17h16" /></svg
                  ></span>
                  <span>Input Kehadiran</span>
                </a>
                <a
                  data-target="page-ketua-riwayat"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path
                        d="M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"
                      /></svg
                  ></span>
                  <span>Riwayat Laporan</span>
                </a>
                <a
                  data-target="page-change-pass"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M12 11V7a4 4 0 1 1 8 0v4" /></svg
                  ></span>
                  <span>Ganti Password</span>
                </a>
              </div>

              <div id="menuLeaders" class="space-y-1 hidden">
                <a
                  data-target="page-dashboard-charts"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M4 19h16M4 13h16M4 7h16" /></svg
                  ></span>
                  <span>Grafik</span>
                </a>
                <a
                  data-target="page-laporan"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M4 19h16M4 13h16M4 7h16" /></svg
                  ></span>
                  <span>Laporan</span>
                </a>
                <a
                  data-target="page-rekap"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M3 3v18" /></svg
                  ></span>
                  <span>Rekapitulasi</span>
                </a>
                <a
                  data-target="page-change-pass"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M12 11V7a4 4 0 1 1 8 0v4" /></svg
                  ></span>
                  <span>Ganti Password</span>
                </a>
              </div>

              <div id="menuAdmin" class="space-y-1 hidden">
                <a
                  data-target="page-admin-akun"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M16 21v-2a4 4 0 0 0-8 0v2" /></svg
                  ></span>
                  <span>Kelola Akun</span>
                </a>
                <a
                  data-target="page-admin-master"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M4 6h16M4 12h16M4 18h16" /></svg
                  ></span>
                  <span>Data Guru & Kelas</span>
                </a>
                <a
                  data-target="page-change-pass"
                  class="menu-link flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 text-slate-800 cursor-pointer transition-fast"
                >
                  <span class="text-primary-500"
                    ><svg
                      width="18"
                      height="18"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      viewBox="0 0 24 24"
                    >
                      <path d="M12 11V7a4 4 0 1 1 8 0v4" /></svg
                  ></span>
                  <span>Ganti Password</span>
                </a>
              </div>

              <div class="pt-4 mt-4 border-t border-slate-200">
                <button
                  id="exportCsv"
                  class="w-full bg-blue-50 hover:bg-blue-100 text-blue-700 font-medium rounded-lg py-2 transition-fast border border-blue-200"
                >
                  Export CSV
                </button>
                <button
                  id="logoutBtn"
                  class="w-full mt-2 bg-transparent hover:bg-slate-50 border border-slate-200 text-slate-800 font-medium rounded-lg py-2 transition-fast"
                >
                  Logout
                </button>
              </div>
            </nav>
          </aside>

          <div id="overlay" class="fixed inset-0 bg-black/50 z-20 hidden"></div>

          <!-- Main -->
          <div class="flex-1 min-w-0 lg:ml-0">
            <header
              class="h-16 bg-white border-b border-slate-200 flex items-center justify-between px-4 sticky top-0 z-10"
            >
              <div class="flex items-center gap-3">
                <button
                  id="openSidebar"
                  class="lg:hidden p-2 rounded hover:bg-slate-100 transition-fast text-slate-800"
                  aria-label="Buka menu"
                >
                  <svg
                    width="22"
                    height="22"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M3 6h18M3 12h18M3 18h18" />
                  </svg>
                </button>
                <div>
                  <div
                    class="text-slate-900 font-semibold leading-tight"
                    id="pageTitle"
                  >
                    Dashboard
                  </div>
                  <div class="text-xs text-slate-500">
                    Monitoring Kehadiran Guru
                  </div>
                </div>
              </div>
              <div class="flex items-center gap-3">
                <div class="hidden sm:flex items-center gap-2 text-slate-600">
                  <svg
                    width="18"
                    height="18"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 6v6l4 2" />
                  </svg>
                  <span id="todayLabel"></span>
                </div>
                <div
                  class="w-9 h-9 rounded-full bg-blue-700 text-white flex items-center justify-center font-bold shadow-soft"
                  id="avatarInitial"
                >
                  U
                </div>
              </div>
            </header>

            <main class="p-4 md:p-6 space-y-6">
              <!-- Charts Dashboard (default view) -->
              <section id="page-dashboard-charts" class="">
                <div
                  class="hiden bg-white border border-slate-200 rounded-2xl shadow-soft p-5 md:p-6"
                >
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-slate-900">
                      Grafik Kehadiran Guru
                    </h3>
                    <span class="text-xs text-slate-600">Grafik</span>
                  </div>

                  <!-- Filters above charts -->
                  <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-4">
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Kelas</label
                      >
                      <select
                        id="chartFilterKelas"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      ></select>
                    </div>
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Guru</label
                      >
                      <select
                        id="chartFilterGuru"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      ></select>
                    </div>
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Tanggal</label
                      >
                      <input
                        type="date"
                        id="chartFilterTanggal"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      />
                    </div>
                    <div class="flex items-end">
                      <button
                        id="btnTampilkanChart"
                        class="w-full bg-blue-700 hover:bg-blue-800 text-white font-semibold rounded-lg py-2.5 transition-fast"
                      >
                        Tampilkan
                      </button>
                    </div>
                  </div>

                  <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
                    <div
                      class="bg-white border border-slate-200 rounded-2xl p-5 xl:col-span-2"
                    >
                      <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-slate-900">
                          Jumlah Entri per Hari
                        </h4>
                        <span class="text-xs text-slate-600">Bar</span>
                      </div>
                      <canvas
                        id="chartBar"
                        class="w-full"
                        height="110"
                      ></canvas>
                    </div>
                    <div
                      class="bg-white border border-slate-200 rounded-2xl p-5"
                    >
                      <div class="flex items-center justify-between mb-3">
                        <h4 class="font-semibold text-slate-900">
                          Perbandingan Status
                        </h4>
                        <span class="text-xs text-slate-600">Pie</span>
                      </div>
                      <canvas
                        id="chartPie"
                        class="w-full"
                        height="110"
                      ></canvas>
                    </div>
                  </div>
                </div>
              </section>

              <!-- Ketua Kelas: Input -->
              <section id="page-ketua-input" class="hidden">
                <div
                  class="bg-white border border-slate-200 rounded-2xl shadow-soft p-5 md:p-6"
                >
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-slate-900">
                      Form Input Kehadiran
                    </h3>
                    <span
                      class="text-xs text-blue-700 bg-blue-100 border border-blue-200 px-2 py-1 rounded"
                      >Hari ini: <span id="todayInline"></span
                    ></span>
                  </div>

                  <form
                    id="formKehadiran"
                    class="grid grid-cols-1 lg:grid-cols-3 gap-6"
                  >
                    <div class="space-y-3 lg:col-span-2">
                      <div>
                        <label
                          class="block text-sm font-medium mb-2 text-slate-800"
                          >Tanggal</label
                        >
                        <input
                          type="date"
                          id="inputTanggal"
                          class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800"
                        />
                      </div>

                      <div>
                        <label
                          class="block text-sm font-medium mb-2 text-slate-800"
                          >Jam Pelajaran ke-</label
                        >
                        <div
                          id="containerJam"
                          class="grid grid-cols-6 sm:grid-cols-8 md:grid-cols-11 gap-2"
                        ></div>
                      </div>

                      <div>
                        <label
                          class="block text-sm font-medium mb-2 text-slate-800"
                          >Status Kehadiran</label
                        >
                        <div class="flex items-center gap-6 text-slate-800">
                          <label
                            class="inline-flex items-center gap-2 cursor-pointer"
                          >
                            <input
                              type="radio"
                              name="status"
                              value="Hadir"
                              required
                              class="text-primary-600"
                            /><span>Hadir</span>
                          </label>
                          <label
                            class="inline-flex items-center gap-2 cursor-pointer"
                          >
                            <input
                              type="radio"
                              name="status"
                              value="Tidak Hadir"
                              class="text-primary-600"
                            /><span>Tidak Hadir</span>
                          </label>
                        </div>
                      </div>

                      <div>
                        <label
                          class="block text-sm font-medium mb-2 text-slate-800"
                          >Nama Guru</label
                        >
                        <select
                          id="inputGuru"
                          class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800"
                        ></select>
                      </div>

                      <div>
                        <label
                          class="block text-sm font-medium mb-2 text-slate-800"
                          >Keterangan (opsional)</label
                        >
                        <div class="relative">
                          <span
                            class="absolute left-3 top-2.5 text-primary-500"
                          >
                            <svg
                              width="18"
                              height="18"
                              fill="none"
                              stroke="currentColor"
                              stroke-width="1.8"
                              viewBox="0 0 24 24"
                            >
                              <path d="M8 21h8M12 17v4M7 4h10v12H7z" />
                            </svg>
                          </span>
                          <input
                            id="inputKet"
                            type="text"
                            placeholder="Tuliskan info ketidakhadiran"
                            class="w-full border border-slate-300 rounded-lg pl-10 pr-3 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800 placeholder-slate-400 transition-fast"
                          />
                        </div>
                      </div>
                    </div>

                    <div class="space-y-4">
                      <div
                        class="bg-primary-50 border border-primary-200 rounded-xl p-4"
                      >
                        <div class="flex items-center gap-2 text-primary-800">
                          <svg
                            width="18"
                            height="18"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                          >
                            <path
                              d="M3 4h18M16 2v4M8 2v4M3 10h18M3 16h18M3 22h18"
                            />
                          </svg>
                          <div>
                            <div class="text-sm font-semibold">
                              Hari & Tanggal
                            </div>
                            <div class="text-sm" id="infoTanggal"></div>
                          </div>
                        </div>
                      </div>

                      <button
                        type="submit"
                        id="btnKirim"
                        class="w-full bg-blue-700 hover:bg-blue-800 text-white font-semibold rounded-lg py-2.5 transition-fast shadow-md shadow-blue-500/20 flex items-center justify-center gap-2"
                      >
                        <span id="btnKirimText">Kirim</span>
                        <span id="btnKirimSpin" class="hidden">
                          <svg
                            class="animate-spin"
                            width="18"
                            height="18"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                          >
                            <circle
                              cx="12"
                              cy="12"
                              r="10"
                              stroke-opacity="0.2"
                            />
                            <path d="M12 2a10 10 0 0 1 10 10" />
                          </svg>
                        </span>
                      </button>
                    </div>
                  </form>
                </div>
              </section>

              <!-- Ketua: Riwayat -->
              <section id="page-ketua-riwayat" class="hidden">
                <div
                  class="bg-white border border-slate-200 rounded-2xl shadow-soft p-5 md:p-6"
                >
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-slate-900">
                      Riwayat Laporan
                    </h3>
                    <div class="flex gap-2">
                      <button
                        id="refreshRiwayat"
                        class="px-3 py-2 rounded-lg bg-blue-50 hover:bg-blue-100 text-blue-800 border border-blue-200 transition-fast"
                      >
                        Refresh Data
                      </button>
                    </div>
                  </div>
                  <div class="table-wrap">
                    <table
                      class="min-w-[720px] w-full border-separate border-spacing-y-2"
                    >
                      <thead>
                        <tr class="text-left text-slate-600 text-sm">
                          <th class="px-3 py-2">Hari</th>
                          <th class="px-3 py-2">Tanggal</th>
                          <th class="px-3 py-2">Kelas</th>
                          <th class="px-3 py-2">Jam Ke-</th>
                          <th class="px-3 py-2">Guru</th>
                          <th class="px-3 py-2">Status</th>
                          <th class="px-3 py-2">Keterangan</th>
                        </tr>
                      </thead>
                      <tbody id="tbodyRiwayat"></tbody>
                    </table>
                  </div>
                </div>
              </section>

              <!-- Leaders: Laporan -->
              <section id="page-laporan" class="hidden">
                <div
                  class="bg-white border border-slate-200 rounded-2xl shadow-soft p-5 md:p-6"
                >
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-slate-900">
                      Laporan Absensi Semua Kelas
                    </h3>
                  </div>

                  <div class="grid grid-cols-1 md:grid-cols-5 gap-3 mb-4">
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Kelas</label
                      >
                      <select
                        id="filterKelas"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      ></select>
                    </div>
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Dari Tanggal</label
                      >
                      <input
                        id="filterStart"
                        type="date"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      />
                    </div>
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Sampai Tanggal</label
                      >
                      <input
                        id="filterEnd"
                        type="date"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      />
                    </div>
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Nama Guru</label
                      >
                      <select
                        id="filterGuru"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      ></select>
                    </div>
                    <div class="flex items-end">
                      <button
                        id="btnReset"
                        class="w-full bg-slate-500 hover:bg-slate-600 text-white font-semibold rounded-lg py-2.5 transition-fast"
                      >
                        Reset
                      </button>
                    </div>
                  </div>

                  <div class="table-wrap">
                    <table
                      class="min-w-[880px] w-full border-separate border-spacing-y-2"
                    >
                      <thead>
                        <tr class="text-left text-slate-600 text-sm">
                          <th class="px-3 py-2">Hari</th>
                          <th class="px-3 py-2">Tanggal</th>
                          <th class="px-3 py-2">Kelas</th>
                          <th class="px-3 py-2">Jam Ke-</th>
                          <th class="px-3 py-2">Guru</th>
                          <th class="px-3 py-2">Status</th>
                          <th class="px-3 py-2">Keterangan</th>
                        </tr>
                      </thead>
                      <tbody id="tbodyLaporan"></tbody>
                    </table>
                  </div>
                </div>
              </section>

              <!-- Leaders: Rekap -->
              <section id="page-rekap" class="hidden">
                <div
                  class="bg-white border border-slate-200 rounded-2xl shadow-soft p-5 md:p-6"
                >
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-slate-900">
                      Rekapitulasi Kehadiran Guru
                    </h3>
                    <div class="flex items-center gap-2">
                      <button
                        id="btnRefreshRekap"
                        class="px-3 py-2 rounded-lg bg-blue-700 hover:bg-blue-800 text-white transition-fast"
                      >
                        Refresh Data
                      </button>
                      <span class="text-xs text-slate-600">Per Minggu</span>
                    </div>
                  </div>

                  <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-4">
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Nama Guru</label
                      >
                      <select
                        id="rekapGuru"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      ></select>
                    </div>
                    <div>
                      <label class="block text-xs text-slate-600 mb-1"
                        >Mapel</label
                      >
                      <select
                        id="rekapMapel"
                        class="w-full border border-slate-300 rounded-lg px-3 py-2.5 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 bg-white text-slate-800"
                      ></select>
                    </div>
                    <div class="flex items-end">
                      <button
                        id="btnRekap"
                        class="w-full bg-blue-700 hover:bg-blue-800 text-white font-semibold rounded-lg py-2.5 transition-fast"
                      >
                        Tampilkan
                      </button>
                    </div>
                  </div>

                  <div class="table-wrap">
                    <table
                      class="min-w-[880px] w-full border-separate border-spacing-y-2"
                    >
                      <thead>
                        <tr class="text-left text-slate-600 text-sm">
                          <th class="px-3 py-2">Nama Guru</th>
                          <th class="px-3 py-2">Mapel</th>
                          <th class="px-3 py-2">Jumlah JP</th>
                          <th class="px-3 py-2">Jumlah Hadir</th>
                          <th class="px-3 py-2">Jumlah Tidak Hadir</th>
                          <th class="px-3 py-2">% Kehadiran</th>
                          <th class="px-3 py-2">Aksi</th>
                        </tr>
                      </thead>
                      <tbody id="tbodyRekap"></tbody>
                    </table>
                  </div>

                  <div class="mt-4 text-sm text-slate-700">
                    Total JP per minggu:
                    <span id="totalJp" class="font-semibold">0</span>
                  </div>
                </div>
              </section>

              <!-- Admin: Akun -->
              <section id="page-admin-akun" class="hidden">
                <div
                  class="bg-white border border-slate-200 rounded-2xl shadow-soft p-5 md:p-6"
                >
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-slate-900">
                      Kelola Akun
                    </h3>
                    <button
                      id="resetAll"
                      class="px-3 py-2 rounded-lg bg-blue-700 hover:bg-blue-800 text-white transition-fast"
                    >
                      Reset Semua Password ke "123456"
                    </button>
                  </div>
                  <div class="table-wrap">
                    <table
                      class="min-w-[680px] w-full border-separate border-spacing-y-2"
                    >
                      <thead>
                        <tr class="text-left text-slate-600 text-sm">
                          <th class="px-3 py-2">Nama Lengkap</th>
                          <th class="px-3 py-2">Username</th>
                          <th class="px-3 py-2">Role</th>
                          <th class="px-3 py-2">Aksi</th>
                        </tr>
                      </thead>
                      <tbody id="tbodyAkun"></tbody>
                    </table>
                  </div>
                </div>
              </section>

              <!-- Admin: Data Master -->
              <section id="page-admin-master" class="hidden">
                <div
                  class="bg-white border border-slate-200 rounded-2xl shadow-soft p-5 md:p-6 space-y-6"
                >
                  <div>
                    <div class="flex items-center justify-between mb-4">
                      <h3 class="text-lg font-semibold text-slate-900">
                        Data Guru
                      </h3>
                      <div class="flex gap-2">
                        <button
                          id="addGuru"
                          class="px-3 py-2 rounded-lg bg-primary-600 hover:bg-primary-700 text-white transition-fast"
                        >
                          Tambah Guru
                        </button>
                      </div>
                    </div>
                    <div class="table-wrap">
                      <table
                        class="min-w-[720px] w-full border-separate border-spacing-y-2"
                      >
                        <thead>
                          <tr class="text-left text-slate-600 text-sm">
                            <th class="px-3 py-2">Nama Guru</th>
                            <th class="px-3 py-2">Mata Pelajaran</th>
                            <th class="px-3 py-2">Jumlah JP</th>
                            <th class="px-3 py-2">Aksi</th>
                          </tr>
                        </thead>
                        <tbody id="tbodyGuru"></tbody>
                      </table>
                    </div>
                  </div>

                  <div>
                    <div class="flex items-center justify-between mb-4">
                      <h3 class="text-lg font-semibold text-slate-900">
                        Data Kelas
                      </h3>
                      <div class="flex gap-2">
                        <button
                          id="addKelas"
                          class="px-3 py-2 rounded-lg bg-primary-600 hover:bg-primary-700 text-white transition-fast"
                        >
                          Tambah Kelas
                        </button>
                      </div>
                    </div>
                    <div class="table-wrap">
                      <table
                        class="min-w-[600px] w-full border-separate border-spacing-y-2"
                      >
                        <thead>
                          <tr class="text-left text-slate-600 text-sm">
                            <th class="px-3 py-2">Nama Kelas</th>
                            <th class="px-3 py-2">Username</th>
                            <th class="px-3 py-2">Password</th>
                            <th class="px-3 py-2">Aksi</th>
                          </tr>
                        </thead>
                        <tbody id="tbodyKelas"></tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </section>

              <!-- Ganti Password -->
              <section id="page-change-pass" class="hidden">
                <div
                  class="bg-white border border-slate-200 rounded-2xl shadow-soft p-5 md:p-6 max-w-xl"
                >
                  <h3 class="text-lg font-semibold text-slate-900 mb-4">
                    Ganti Password
                  </h3>
                  <form id="formChangePass" class="space-y-4">
                    <!-- Password Lama -->
                    <div>
                      <label
                        class="block text-sm font-medium mb-1 text-slate-700"
                        >Password Lama</label
                      >
                      <div class="relative">
                        <input
                          id="oldPass"
                          type="password"
                          required
                          class="w-full border border-slate-300 rounded-lg pl-3 pr-10 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800"
                        />
                        <button
                          type="button"
                          class="togglePass absolute right-2 top-2.5 text-slate-500 hover:text-slate-700 p-1"
                          data-target="oldPass"
                        >
                          👁
                        </button>
                      </div>
                    </div>

                    <!-- Password Baru -->
                    <div>
                      <label
                        class="block text-sm font-medium mb-1 text-slate-700"
                        >Password Baru</label
                      >
                      <div class="relative">
                        <input
                          id="newPass"
                          type="password"
                          required
                          class="w-full border border-slate-300 rounded-lg pl-3 pr-10 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800"
                        />
                        <button
                          type="button"
                          class="togglePass absolute right-2 top-2.5 text-slate-500 hover:text-slate-700 p-1"
                          data-target="newPass"
                        >
                          👁
                        </button>
                      </div>
                      <small id="passHelp" class="text-xs text-slate-500">
                        Minimal 8 karakter, ada huruf, angka, dan simbol.
                      </small>
                    </div>

                    <!-- Konfirmasi Password -->
                    <div>
                      <label
                        class="block text-sm font-medium mb-1 text-slate-700"
                        >Konfirmasi Password Baru</label
                      >
                      <div class="relative">
                        <input
                          id="newPass2"
                          type="password"
                          required
                          class="w-full border border-slate-300 rounded-lg pl-3 pr-10 py-2.5 focus:border-primary-400 focus:ring-2 focus:ring-primary-100 bg-white text-slate-800"
                        />
                        <button
                          type="button"
                          class="togglePass absolute right-2 top-2.5 text-slate-500 hover:text-slate-700 p-1"
                          data-target="newPass2"
                        >
                          👁
                        </button>
                      </div>
                    </div>

                    <button
                      id="btnSavePass"
                      class="bg-primary-600 hover:bg-primary-700 text-white font-semibold rounded-lg py-2.5 px-4 transition-fast"
                    >
                      Simpan
                    </button>
                  </form>
                </div>
              </section>

              <!-- Empty (not used as default anymore) -->
              <section id="page-empty" class="hidden">
                <div
                  class="bg-white border border-slate-200 rounded-2xl shadow-soft p-10 text-center"
                >
                  <div
                    class="mx-auto w-16 h-16 rounded-full bg-primary-50 border border-primary-200 text-primary-700 flex items-center justify-center mb-4"
                  >
                    <svg
                      width="28"
                      height="28"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path d="M3 3v18h18" />
                      <path d="M7 13h8M7 9h12M7 17h3" />
                    </svg>
                  </div>
                  <h3 class="text-lg font-semibold text-slate-900 mb-1">
                    Pilih menu di sebelah kiri
                  </h3>
                  <p class="text-slate-700">Grafik</p>
                </div>
              </section>
            </main>
          </div>
        </div>
      </section>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Hubungkan JavaScript -->
    <script src="app1.js"></script>

    <!-- Detail Modal -->
    <div id="detailModal" class="hidden fixed inset-0 z-50">
      <div
        id="detailOverlay"
        class="absolute inset-0 bg-black/40"
        onclick="closeDetailModal()"
      ></div>
      <div
        class="relative max-w-2xl mx-auto mt-24 bg-white border border-slate-200 rounded-2xl shadow-soft p-6"
      >
        <div class="flex items-center justify-between mb-4">
          <h4 id="detailTitle" class="text-lg font-semibold text-slate-900">
            Detail
          </h4>
          <button
            id="detailClose"
            class="p-2 rounded hover:bg-slate-100"
            onclick="closeDetailModal()"
          >
            ✕
          </button>
        </div>
        <div id="detailBody" class="max-h-[60vh] overflow-auto space-y-2"></div>
        <div class="mt-4 text-right">
          <button
            id="detailClose2"
            onclick="closeDetailModal()"
            class="px-4 py-2 rounded-lg bg-blue-700 hover:bg-blue-800 text-white"
          >
            Tutup
          </button>
        </div>
      </div>
    </div>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'971718f2a7fbfe8c',t:'MTc1NTU3OTczMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>

